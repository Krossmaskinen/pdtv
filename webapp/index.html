<!DOCTYPE html>
<html>

 <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100% }
    </style>
    
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAL0pWarYqD1A3W5IXtr7xhNwQr4Mohxsk&sensor=true&libraries=visualization">
    </script>
    
    <script type="text/javascript">

	   
	    
	function initialize()
	{
		
		var heatmapData = [
		            {
		            	name: "dn.se",
						ip: "216.206.30.40",
						country: "US",
						city: "Dallas",
						location: new google.maps.LatLng(32.780140,-96.800451),
						weight:1
		            },
		            {
		            	name: "aftonbladet.se",
						ip: "144.63.250.5",
						country: "SV",
						city: "Stockholm",
						location: new google.maps.LatLng( 59.3333 , 18.05 ),
						weight:1
		            },
		            {
		            	name: "expressen.se",
						ip: "66.171.224.114",
						country: "US",
						city: "Cambridge",
						location: new google.maps.LatLng( 42.3626 , -71.0843 ),
						weight:1
		            },
		            {
		            	name: "svd.se",
						ip: "144.63.252.10",
						country: "SV",
						city: "Stockholm",
						location: new google.maps.LatLng( 59.3333 , 18.05 ),
						weight:1
		            },
		            {
		            	name: "kth.se",
						ip: "130.237.32.143",
						country: "SV",
						city: "Stockholm",
						location: new google.maps.LatLng(59.3,17.9667),
						weight:1
		            }
					
					];

		// Denna funktion tycker jag borde ligga utanför initialize men kommer inte åt objektet map då 
		function center_map(loc) 
		{
			var lat = loc.coords.latitude;
			var lon = loc.coords.longitude;
			map.setCenter(new google.maps.LatLng(lat, lon));
		}
		
		
		function set_markers(data)
		{
			data.forEach(function(element){
				marker = new google.maps.Marker({
				position: element.location,
				title: element.name,
				map: map
			})})
				
			
		}
    	  	
		var mapOptions = 
		{
          center: new google.maps.LatLng(-34.397, 150.644),
          zoom: 3
        };
        
		var map = new google.maps.Map(document.getElementById("map-canvas"),mapOptions);       
		
		navigator.geolocation.getCurrentPosition(center_map);
		
		set_markers(heatmapData);
		
		var heatmap = new google.maps.visualization.HeatmapLayer({
			  data: heatmapData,
			  opacity: 0.8,
			  map: map
			  });
	}
	
	google.maps.event.addDomListener(window, 'load', initialize);
      
      
      
    </script>
  </head>
  <body>
    <div id="map-canvas"/>
  </body>


</html>